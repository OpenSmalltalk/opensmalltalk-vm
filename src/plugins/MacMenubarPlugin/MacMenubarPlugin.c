/* Automatically generated by
	SmartSyntaxPluginCodeGenerator VMMaker.oscog-eem.3220 uuid: 1a04ca73-fe89-4ffe-8a60-d00f9b55dc14
   from
	MacMenubarPlugin VMMaker.oscog-eem.3220 uuid: 1a04ca73-fe89-4ffe-8a60-d00f9b55dc14
 */
static char __buildInfo[] = "MacMenubarPlugin VMMaker.oscog-eem.3220 uuid: 1a04ca73-fe89-4ffe-8a60-d00f9b55dc14 " __DATE__ ;


#include "config.h"
#include <math.h>
#include "sqMathShim.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

/* Do not include the entire sq.h file but just those parts needed. */
#include "sqConfig.h"			/* Configuration options */
#include "sqVirtualMachine.h"	/*  The virtual machine proxy definition */
#include "sqPlatformSpecific.h"	/* Platform specific definitions */

#include "MacMenubarPlugin.h"
#include "sqMemoryAccess.h"

#define true 1
#define false 0
#define null 0  /* using 'null' because nil is predefined in Think C */
#ifdef SQUEAK_BUILTIN_PLUGIN
# undef EXPORT
# define EXPORT(returnType) static returnType
# define INT_EXT "(i)"
#else
# define INT_EXT "(e)"
#endif


/*** Function Prototypes ***/
EXPORT(const char*) getModuleName(void);
EXPORT(sqInt) primitiveAppendMenu(void);
EXPORT(sqInt) primitiveAppendMenuItemText(void);
EXPORT(sqInt) primitiveCheckMenuItem(void);
EXPORT(sqInt) primitiveClearMenuBar(void);
EXPORT(sqInt) primitiveCountMenuItems(void);
EXPORT(sqInt) primitiveCreateStandardWindowMenu(void);
EXPORT(sqInt) primitiveDeleteMenu(void);
EXPORT(sqInt) primitiveDeleteMenuItem(void);
EXPORT(sqInt) primitiveDisableMenuCommand(void);
EXPORT(sqInt) primitiveDisableMenuItem(void);
EXPORT(sqInt) primitiveDisableMenuItemIcon(void);
EXPORT(sqInt) primitiveDisposeMenu(void);
EXPORT(sqInt) primitiveDisposeMenuBar(void);
EXPORT(sqInt) primitiveDrawMenuBar(void);
EXPORT(sqInt) primitiveEnableMenuCommand(void);
EXPORT(sqInt) primitiveEnableMenuItem(void);
EXPORT(sqInt) primitiveEnableMenuItemIcon(void);
EXPORT(sqInt) primitiveGetIndMenuItemWithCommandID(void);
EXPORT(sqInt) primitiveGetIndMenuWithCommandID(void);
EXPORT(sqInt) primitiveGetItemCmd(void);
EXPORT(sqInt) primitiveGetItemIcon(void);
EXPORT(sqInt) primitiveGetItemMark(void);
EXPORT(sqInt) primitiveGetItemStyle(void);
EXPORT(sqInt) primitiveGetMenuBar(void);
EXPORT(sqInt) primitiveGetMenuHandle(void);
EXPORT(sqInt) primitiveGetMenuID(void);
EXPORT(sqInt) primitiveGetMenuItemCommandID(void);
EXPORT(sqInt) primitiveGetMenuItemFontID(void);
EXPORT(sqInt) primitiveGetMenuItemHierarchicalID(void);
EXPORT(sqInt) primitiveGetMenuItemKeyGlyph(void);
EXPORT(sqInt) primitiveGetMenuItemModifiers(void);
EXPORT(sqInt) primitiveGetMenuItemText(void);
EXPORT(sqInt) primitiveGetMenuItemTextEncoding(void);
EXPORT(sqInt) primitiveGetMenuTitle(void);
EXPORT(sqInt) primitiveHideMenuBar(void);
EXPORT(sqInt) primitiveHiliteMenu(void);
EXPORT(sqInt) primitiveInsertFontResMenu(void);
EXPORT(sqInt) primitiveInsertIntlResMenu(void);
EXPORT(sqInt) primitiveInsertMenu(void);
EXPORT(sqInt) primitiveInsertMenuItem(void);
EXPORT(sqInt) primitiveInvalMenuBar(void);
EXPORT(sqInt) primitiveIsMenuBarVisible(void);
EXPORT(sqInt) primitiveIsMenuItemEnabled(void);
EXPORT(sqInt) primitiveIsMenuItemIconEnabled(void);
EXPORT(sqInt) primitiveNewMenu(void);
EXPORT(sqInt) primitiveSetItemCmd(void);
EXPORT(sqInt) primitiveSetItemIcon(void);
EXPORT(sqInt) primitiveSetItemMark(void);
EXPORT(sqInt) primitiveSetItemStyle(void);
EXPORT(sqInt) primitiveSetMenuBar(void);
EXPORT(sqInt) primitiveSetMenuItemCommandID(void);
EXPORT(sqInt) primitiveSetMenuItemFontID(void);
EXPORT(sqInt) primitiveSetMenuItemHierarchicalID(void);
EXPORT(sqInt) primitiveSetMenuItemKeyGlyph(void);
EXPORT(sqInt) primitiveSetMenuItemModifiers(void);
EXPORT(sqInt) primitiveSetMenuItemText(void);
EXPORT(sqInt) primitiveSetMenuItemTextEncoding(void);
EXPORT(sqInt) primitiveSetMenuTitle(void);
EXPORT(sqInt) primitiveShowMenuBar(void);
EXPORT(sqInt) setInterpreter(struct VirtualMachine *anInterpreter);


/*** Variables ***/

#if !defined(SQUEAK_BUILTIN_PLUGIN)
static sqInt (*booleanValueOf)(sqInt obj);
static sqInt (*classString)(void);
static sqInt (*failed)(void);
static sqInt (*falseObject)(void);
static void * (*firstIndexableField)(sqInt oop);
static sqInt (*instantiateClassindexableSize)(sqInt classPointer, sqInt size);
#if !defined(integerObjectOf)
static sqInt (*integerObjectOf)(sqInt value);
#endif
#if !defined(integerValueOf)
static sqInt (*integerValueOf)(sqInt oop);
#endif
static sqInt (*isBooleanObject)(sqInt oop);
static sqInt (*isBytes)(sqInt oop);
#if !defined(isIntegerObject)
static sqInt (*isIntegerObject)(sqInt objectPointer);
#endif
static sqInt (*methodReturnInteger)(sqInt integer);
static sqInt (*methodReturnValue)(sqInt oop);
static sqInt (*positive32BitIntegerFor)(unsigned int integerValue);
static usqInt (*positive32BitValueOf)(sqInt oop);
static sqInt (*positive64BitIntegerFor)(usqLong integerValue);
static usqIntptr_t (*positiveMachineIntegerValueOf)(sqInt oop);
static sqInt (*primitiveFailFor)(sqInt reasonCode);
static sqInt (*stackValue)(sqInt offset);
static sqInt (*success)(sqInt aBoolean);
static sqInt (*trueObject)(void);
#else /* !defined(SQUEAK_BUILTIN_PLUGIN) */
extern sqInt booleanValueOf(sqInt obj);
extern sqInt classString(void);
extern sqInt failed(void);
extern sqInt falseObject(void);
extern void * firstIndexableField(sqInt oop);
extern sqInt instantiateClassindexableSize(sqInt classPointer, sqInt size);
#if !defined(integerObjectOf)
extern sqInt integerObjectOf(sqInt value);
#endif
#if !defined(integerValueOf)
extern sqInt integerValueOf(sqInt oop);
#endif
#if VM_PROXY_MAJOR > 1 || (VM_PROXY_MAJOR == 1 && VM_PROXY_MINOR >= 15)
extern sqInt isBooleanObject(sqInt oop);
#else
# define isBooleanObject(oop) 0
#endif
extern sqInt isBytes(sqInt oop);
#if !defined(isIntegerObject)
extern sqInt isIntegerObject(sqInt objectPointer);
#endif
extern sqInt methodReturnInteger(sqInt integer);
extern sqInt methodReturnValue(sqInt oop);
extern sqInt positive32BitIntegerFor(unsigned int integerValue);
extern usqInt positive32BitValueOf(sqInt oop);
extern sqInt positive64BitIntegerFor(usqLong integerValue);
extern usqIntptr_t positiveMachineIntegerValueOf(sqInt oop);
extern sqInt primitiveFailFor(sqInt reasonCode);
extern sqInt stackValue(sqInt offset);
extern sqInt success(sqInt aBoolean);
extern sqInt trueObject(void);
extern
#endif
struct VirtualMachine* interpreterProxy;
static const char *moduleName = "MacMenubarPlugin VMMaker.oscog-eem.3220 " INT_EXT;



/*	Note: This is hardcoded so it can be run from Squeak.
	The module name is used for validating a module *after*
	it is loaded to check if it does really contain the module
	we're thinking it contains. This is important! */

	/* InterpreterPlugin>>#getModuleName */
EXPORT(const char*)
getModuleName(void)
{
	return moduleName;
}

	/* MacMenubarPlugin>>#primitiveAppendMenu:data: */
EXPORT(sqInt)
primitiveAppendMenu(void)
{
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	char *str255;

	if (!(isBytes(stackValue(0)))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	str255 = firstIndexableField(stackValue(0));
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	constStr255 = ((ConstStr255Param) str255);
	AppendMenu(menuHandle,constStr255);
	return null;
}

	/* MacMenubarPlugin>>#primitiveAppendMenuItemText:data: */
EXPORT(sqInt)
primitiveAppendMenuItemText(void)
{
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	char *str255;

	if (!(isBytes(stackValue(0)))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	str255 = firstIndexableField(stackValue(0));
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	constStr255 = ((ConstStr255Param) str255);
	AppendMenuItemText(menuHandle,constStr255);
	return null;
}

	/* MacMenubarPlugin>>#primitiveCheckMenuItem:item:checked: */
EXPORT(sqInt)
primitiveCheckMenuItem(void)
{
	sqInt aBoolean;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isBooleanObject(stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aBoolean = booleanValueOf(stackValue(0));
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	CheckMenuItem(menuHandle,anInteger,aBoolean);
	return null;
}

	/* MacMenubarPlugin>>#primitiveClearMenuBar */
EXPORT(sqInt)
primitiveClearMenuBar(void)
{
	ClearMenuBar();
	return null;
}

	/* MacMenubarPlugin>>#primitiveCountMenuItems: */
EXPORT(sqInt)
primitiveCountMenuItems(void)
{
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt returnValue;

	menuHandleOop = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	returnValue = CountMenuItems(menuHandle);
	if (!(failed())) {
		methodReturnInteger(returnValue);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveCreateStandardWindowMenu: */
EXPORT(sqInt)
primitiveCreateStandardWindowMenu(void)
{
	sqInt inOptions;
	MenuHandle menuHandle;
	sqInt result;
	sqInt _return_value;

	if (!(isIntegerObject((inOptions = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	inOptions = integerValueOf(inOptions);
#  if TARGET_API_MAC_CARBON
	result = CreateStandardWindowMenu(inOptions,&menuHandle);
#  endif
	if (!(failed())) {
		/* begin positiveMachineIntegerFor: */
		_return_value = (BytesPerWord == 8
			? positive64BitIntegerFor(((usqIntptr_t) menuHandle))
			: positive32BitIntegerFor(((usqIntptr_t) menuHandle)));
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveDeleteMenu: */
EXPORT(sqInt)
primitiveDeleteMenu(void)
{
	MenuID menuID;

	if (!(isIntegerObject((menuID = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuID = integerValueOf(menuID);
	DeleteMenu(menuID);
	return null;
}

	/* MacMenubarPlugin>>#primitiveDeleteMenuItem:item: */
EXPORT(sqInt)
primitiveDeleteMenuItem(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	DeleteMenuItem(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveDisableMenuCommand:item: */
EXPORT(sqInt)
primitiveDisableMenuCommand(void)
{
	sqInt anInteger;
	MenuCommand commandID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	menuHandleOop = stackValue(1);
	anInteger = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	commandID = ((MenuCommand) (positive32BitValueOf(anInteger)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
#  if TARGET_API_MAC_CARBON
	DisableMenuCommand(menuHandle,commandID);
#  endif
	return null;
}

	/* MacMenubarPlugin>>#primitiveDisableMenuItem:item: */
EXPORT(sqInt)
primitiveDisableMenuItem(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	DisableMenuItem(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveDisableMenuItemIcon:item: */
EXPORT(sqInt)
primitiveDisableMenuItemIcon(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	DisableMenuItemIcon(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveDisposeMenu: */
EXPORT(sqInt)
primitiveDisposeMenu(void)
{
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	menuHandleOop = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	DisposeMenu(menuHandle);
	return null;
}

	/* MacMenubarPlugin>>#primitiveDisposeMenuBar: */
EXPORT(sqInt)
primitiveDisposeMenuBar(void)
{
	Handle menuBarHandle;
	sqInt menuHandleOop;

	menuHandleOop = stackValue(0);
	menuBarHandle = ((Handle) (positiveMachineIntegerValueOf(menuHandleOop)));
#  if TARGET_API_MAC_CARBON
	DisposeMenuBar(menuBarHandle);
#  else
	DisposeHandle(menuBarHandle);
#  endif
	return null;
}

	/* MacMenubarPlugin>>#primitiveDrawMenuBar */
EXPORT(sqInt)
primitiveDrawMenuBar(void)
{
	DrawMenuBar();
	return null;
}

	/* MacMenubarPlugin>>#primitiveEnableMenuCommand:item: */
EXPORT(sqInt)
primitiveEnableMenuCommand(void)
{
	sqInt anInteger;
	MenuCommand commandID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	menuHandleOop = stackValue(1);
	anInteger = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	commandID = ((MenuCommand) (positive32BitValueOf(anInteger)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
#  if TARGET_API_MAC_CARBON
	EnableMenuCommand(menuHandle,commandID);
#  endif
	return null;
}

	/* MacMenubarPlugin>>#primitiveEnableMenuItem:item: */
EXPORT(sqInt)
primitiveEnableMenuItem(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	EnableMenuItem(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveEnableMenuItemIcon:item: */
EXPORT(sqInt)
primitiveEnableMenuItemIcon(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	EnableMenuItemIcon(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetIndMenuItemWithCommandID:commandID: */
EXPORT(sqInt)
primitiveGetIndMenuItemWithCommandID(void)
{
	sqInt aCommandID;
	MenuHandle applicationMenu;
	MenuCommand commandID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	MenuItemIndex outIndex;

	menuHandleOop = stackValue(1);
	aCommandID = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	commandID = ((MenuCommand) (positive32BitValueOf(aCommandID)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
#  if TARGET_API_MAC_CARBON
	GetIndMenuItemWithCommandID(menuHandle, kHICommandHide, 1,
                   &applicationMenu, &outIndex);
#  endif
	if (!(failed())) {
		methodReturnInteger(outIndex);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetIndMenuWithCommandID:commandID: */
EXPORT(sqInt)
primitiveGetIndMenuWithCommandID(void)
{
	sqInt aCommandID;
	MenuHandle applicationMenu;
	MenuCommand commandID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	MenuItemIndex outIndex;
	sqInt _return_value;

	menuHandleOop = stackValue(1);
	aCommandID = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	commandID = ((MenuCommand) (positive32BitValueOf(aCommandID)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
#  if TARGET_API_MAC_CARBON
	GetIndMenuItemWithCommandID(menuHandle, kHICommandHide, 1,
                   &applicationMenu, &outIndex);
#  endif
	integerObjectOf(outIndex);
	if (!(failed())) {
		/* begin positiveMachineIntegerFor: */
		_return_value = (BytesPerWord == 8
			? positive64BitIntegerFor(((usqIntptr_t) applicationMenu))
			: positive32BitIntegerFor(((usqIntptr_t) applicationMenu)));
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetItemCmd:item: */
EXPORT(sqInt)
primitiveGetItemCmd(void)
{
	CharParameter aCharacter;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aCharacter = 0;
	GetItemCmd(menuHandle,anInteger,&aCharacter);
	if (!(failed())) {
		methodReturnInteger(aCharacter);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetItemIcon:item: */
EXPORT(sqInt)
primitiveGetItemIcon(void)
{
	sqInt anInteger;
	short iconIndex;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	iconIndex = 0;
	GetItemIcon(menuHandle,anInteger,&iconIndex);
	if (!(failed())) {
		methodReturnInteger(iconIndex);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetItemMark:item: */
EXPORT(sqInt)
primitiveGetItemMark(void)
{
	CharParameter aCharacter;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aCharacter = 0;
	GetItemMark(menuHandle,anInteger,&aCharacter);
	if (!(failed())) {
		methodReturnInteger(aCharacter);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetItemStyle:item: */
EXPORT(sqInt)
primitiveGetItemStyle(void)
{
	sqInt anInteger;
	Style chStyle;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	chStyle = 0;
	GetItemStyle(menuHandle,anInteger,&chStyle);
	if (!(failed())) {
		methodReturnInteger(chStyle);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuBar */
EXPORT(sqInt)
primitiveGetMenuBar(void)
{
	Handle menuHandle;
	sqInt _return_value;

	menuHandle = GetMenuBar();
	if (!(failed())) {
		/* begin positiveMachineIntegerFor: */
		_return_value = (BytesPerWord == 8
			? positive64BitIntegerFor(((usqIntptr_t) menuHandle))
			: positive32BitIntegerFor(((usqIntptr_t) menuHandle)));
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuHandle: */
EXPORT(sqInt)
primitiveGetMenuHandle(void)
{
	MenuHandle menuHandle;
	MenuID menuID;
	sqInt _return_value;

	if (!(isIntegerObject((menuID = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuID = integerValueOf(menuID);
	menuHandle = GetMenuHandle(menuID);
	if (!(failed())) {
		/* begin positiveMachineIntegerFor: */
		_return_value = (BytesPerWord == 8
			? positive64BitIntegerFor(((usqIntptr_t) menuHandle))
			: positive32BitIntegerFor(((usqIntptr_t) menuHandle)));
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuID: */
EXPORT(sqInt)
primitiveGetMenuID(void)
{
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	MenuID menuID;

	menuHandleOop = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	menuID = GetMenuID(menuHandle);
	if (!(failed())) {
		methodReturnInteger(menuID);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemCommandID:item: */
EXPORT(sqInt)
primitiveGetMenuItemCommandID(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	MenuCommand outCommandID;
	sqInt _return_value;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	outCommandID = 0;
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	GetMenuItemCommandID(menuHandle,anInteger,&outCommandID);
	if (!(failed())) {
		_return_value = positive32BitIntegerFor(outCommandID);
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemFontID:item: */
EXPORT(sqInt)
primitiveGetMenuItemFontID(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	SInt16 outFontID;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	outFontID = 0;
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	GetMenuItemFontID(menuHandle,anInteger,&outFontID);
	if (!(failed())) {
		methodReturnInteger(outFontID);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemHierarchicalID:item: */
EXPORT(sqInt)
primitiveGetMenuItemHierarchicalID(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	MenuID outHierID;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	outHierID = 0;
	GetMenuItemHierarchicalID(menuHandle,anInteger,&outHierID);
	if (!(failed())) {
		methodReturnInteger(outHierID);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemKeyGlyph:item: */
EXPORT(sqInt)
primitiveGetMenuItemKeyGlyph(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	SInt16 outGlyph;
	sqInt _return_value;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	outGlyph = 0;
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	GetMenuItemKeyGlyph(menuHandle,anInteger,&outGlyph);
	if (!(failed())) {
		_return_value = positive32BitIntegerFor(outGlyph);
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemModifiers:item: */
EXPORT(sqInt)
primitiveGetMenuItemModifiers(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	Style outModifers;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	outModifers = 0;
	GetMenuItemModifiers(menuHandle,anInteger,&outModifers);
	if (!(failed())) {
		methodReturnInteger(outModifers);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemText:item: */
EXPORT(sqInt)
primitiveGetMenuItemText(void)
{
	sqInt anInteger;
	Str255 aString;
	sqInt i;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt oop;
	char *ptr;
	sqInt size;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aString[0] = 0;
	GetMenuItemText(menuHandle,anInteger,aString);
	size = aString[0];
	oop = instantiateClassindexableSize(classString(), size);
	ptr = firstIndexableField(oop);
	for (i = 0; i < size; i += 1) {
		ptr[i] = (aString[i + 1]);
	}
	if (!(failed())) {
		methodReturnValue(oop);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuItemTextEncoding:item: */
EXPORT(sqInt)
primitiveGetMenuItemTextEncoding(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	TextEncoding outScriptID;
	sqInt _return_value;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	GetMenuItemTextEncoding(menuHandle,anInteger,&outScriptID);
	if (!(failed())) {
		_return_value = positive32BitIntegerFor(outScriptID);
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveGetMenuTitle: */
EXPORT(sqInt)
primitiveGetMenuTitle(void)
{
	Str255 aString;
	sqInt i;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt oop;
	char *ptr;
	sqInt size;

	menuHandleOop = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aString[0] = 0;
	GetMenuTitle(menuHandle,aString);
	size = aString[0];
	oop = instantiateClassindexableSize(classString(), size);
	ptr = firstIndexableField(oop);
	for (i = 0; i < size; i += 1) {
		ptr[i] = (aString[i + 1]);
	}
	if (!(failed())) {
		methodReturnValue(oop);
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveHideMenuBar */
EXPORT(sqInt)
primitiveHideMenuBar(void)
{
	HideMenuBar();
	return null;
}

	/* MacMenubarPlugin>>#primitiveHiliteMenu: */
EXPORT(sqInt)
primitiveHiliteMenu(void)
{
	MenuID menuID;

	if (!(isIntegerObject((menuID = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuID = integerValueOf(menuID);
	HiliteMenu(menuID);
	return null;
}

	/* MacMenubarPlugin>>#primitiveInsertFontResMenu:afterItem:scriptFilter: */
EXPORT(sqInt)
primitiveInsertFontResMenu(void)
{
	sqInt afterItemInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt scriptFilterInteger;

	if (!((isIntegerObject((afterItemInteger = stackValue(1))))
		 && (isIntegerObject((scriptFilterInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	afterItemInteger = integerValueOf(afterItemInteger);
	scriptFilterInteger = integerValueOf(scriptFilterInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	InsertFontResMenu(menuHandle,afterItemInteger,scriptFilterInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveInsertIntlResMenu:theType:afterItem:scriptFilter: */
EXPORT(sqInt)
primitiveInsertIntlResMenu(void)
{
	sqInt afterItemInteger;
	sqInt aResType;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	ResType resType;
	sqInt scriptFilterInteger;

	if (!((isIntegerObject((aResType = stackValue(2))))
		 && ((isIntegerObject((afterItemInteger = stackValue(1))))
		 && (isIntegerObject((scriptFilterInteger = stackValue(0))))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(3);
	aResType = integerValueOf(aResType);
	afterItemInteger = integerValueOf(afterItemInteger);
	scriptFilterInteger = integerValueOf(scriptFilterInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	resType = ((ResType) (positive32BitValueOf(aResType)));
	InsertIntlResMenu(menuHandle,resType,afterItemInteger,scriptFilterInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveInsertMenu:beforeID: */
EXPORT(sqInt)
primitiveInsertMenu(void)
{
	MenuID anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	InsertMenu(menuHandle,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveInsertMenuItem:itemString:afterItem: */
EXPORT(sqInt)
primitiveInsertMenuItem(void)
{
	sqInt anInteger;
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	char *str255;

	if (!((isBytes(stackValue(1)))
		 && (isIntegerObject((anInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	str255 = firstIndexableField(stackValue(1));
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	constStr255 = ((ConstStr255Param) str255);
	InsertMenuItem(menuHandle,constStr255,anInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveInvalMenuBar */
EXPORT(sqInt)
primitiveInvalMenuBar(void)
{
	InvalMenuBar();
	return null;
}

	/* MacMenubarPlugin>>#primitiveIsMenuBarVisible */
EXPORT(sqInt)
primitiveIsMenuBarVisible(void)
{
	sqInt result;
	sqInt _return_value;

	result = IsMenuBarVisible();
	if (!(failed())) {
		_return_value = ((result) ? trueObject() : falseObject());
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveIsMenuItemEnabled:item: */
EXPORT(sqInt)
primitiveIsMenuItemEnabled(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt result;
	sqInt _return_value;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	result = IsMenuItemEnabled(menuHandle,anInteger);
	if (!(failed())) {
		_return_value = ((result) ? trueObject() : falseObject());
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveIsMenuItemIconEnabled:item: */
EXPORT(sqInt)
primitiveIsMenuItemIconEnabled(void)
{
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	sqInt result;
	sqInt _return_value;

	if (!(isIntegerObject((anInteger = stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	anInteger = integerValueOf(anInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	result = IsMenuItemIconEnabled(menuHandle,anInteger);
	if (!(failed())) {
		_return_value = ((result) ? trueObject() : falseObject());
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveNewMenu:menuTitle: */
EXPORT(sqInt)
primitiveNewMenu(void)
{
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	MenuID menuID;
	char *menuTitle;
	sqInt _return_value;

	if (!((isIntegerObject((menuID = stackValue(1))))
		 && (isBytes(stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuID = integerValueOf(menuID);
	menuTitle = firstIndexableField(stackValue(0));
	constStr255 = ((ConstStr255Param) menuTitle);
	menuHandle = NewMenu(menuID,constStr255);
	if (!(failed())) {
		/* begin positiveMachineIntegerFor: */
		_return_value = (BytesPerWord == 8
			? positive64BitIntegerFor(((usqIntptr_t) menuHandle))
			: positive32BitIntegerFor(((usqIntptr_t) menuHandle)));
		if (!(failed())) {
			methodReturnValue(_return_value);
		}
	}
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetItemCmd:item:cmdChar: */
EXPORT(sqInt)
primitiveSetItemCmd(void)
{
	CharParameter aCharacter;
	sqInt anInteger;
	sqInt anIntegerCmdChar;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((anIntegerCmdChar = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	anIntegerCmdChar = integerValueOf(anIntegerCmdChar);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aCharacter = anIntegerCmdChar;
	SetItemCmd(menuHandle,anInteger,aCharacter);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetItemIcon:item:iconIndex: */
EXPORT(sqInt)
primitiveSetItemIcon(void)
{
	sqInt aIconIndexInteger;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((aIconIndexInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aIconIndexInteger = integerValueOf(aIconIndexInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetItemIcon(menuHandle,anInteger,aIconIndexInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetItemMark:item:markChar: */
EXPORT(sqInt)
primitiveSetItemMark(void)
{
	CharParameter aCharacter;
	sqInt aMarkChar;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((aMarkChar = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aMarkChar = integerValueOf(aMarkChar);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	aCharacter = aMarkChar;
	SetItemMark(menuHandle,anInteger,aCharacter);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetItemStyle:item:styleParameter: */
EXPORT(sqInt)
primitiveSetItemStyle(void)
{
	sqInt anInteger;
	sqInt chStyleInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((chStyleInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	chStyleInteger = integerValueOf(chStyleInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetItemStyle(menuHandle,anInteger,chStyleInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuBar: */
EXPORT(sqInt)
primitiveSetMenuBar(void)
{
	MenuBarHandle menuBarHandle;
	sqInt menuHandleOop;

	menuHandleOop = stackValue(0);
	menuBarHandle = ((MenuBarHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	SetMenuBar(menuBarHandle);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemCommandID:item:menuCommand: */
EXPORT(sqInt)
primitiveSetMenuItemCommandID(void)
{
	sqInt anInteger;
	MenuCommand commandID;
	sqInt inCommandID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(1))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	inCommandID = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	commandID = ((MenuCommand) (positive32BitValueOf(inCommandID)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetMenuItemCommandID(menuHandle,anInteger,commandID);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemFontID:item:fontID: */
EXPORT(sqInt)
primitiveSetMenuItemFontID(void)
{
	sqInt aFontIDInteger;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((aFontIDInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aFontIDInteger = integerValueOf(aFontIDInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetMenuItemFontID(menuHandle,anInteger,aFontIDInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemHierarchicalID:item:hierID: */
EXPORT(sqInt)
primitiveSetMenuItemHierarchicalID(void)
{
	MenuID aMenuID;
	sqInt anInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((aMenuID = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aMenuID = integerValueOf(aMenuID);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetMenuItemHierarchicalID(menuHandle,anInteger,aMenuID);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemKeyGlyph:item:glyph: */
EXPORT(sqInt)
primitiveSetMenuItemKeyGlyph(void)
{
	sqInt anInteger;
	sqInt inGlyphInteger;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((inGlyphInteger = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	inGlyphInteger = integerValueOf(inGlyphInteger);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetMenuItemKeyGlyph(menuHandle,anInteger,inGlyphInteger);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemModifiers:item:inModifiers: */
EXPORT(sqInt)
primitiveSetMenuItemModifiers(void)
{
	sqInt anInteger;
	sqInt aUInt8;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isIntegerObject((aUInt8 = stackValue(0)))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aUInt8 = integerValueOf(aUInt8);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	SetMenuItemModifiers(menuHandle,anInteger,aUInt8);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemText:item:itemString: */
EXPORT(sqInt)
primitiveSetMenuItemText(void)
{
	sqInt anInteger;
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	char *str255;

	if (!((isIntegerObject((anInteger = stackValue(1))))
		 && (isBytes(stackValue(0))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	str255 = firstIndexableField(stackValue(0));
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	constStr255 = ((ConstStr255Param) str255);
	SetMenuItemText(menuHandle,anInteger,constStr255);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuItemTextEncoding:item:inScriptID: */
EXPORT(sqInt)
primitiveSetMenuItemTextEncoding(void)
{
	sqInt anInteger;
	sqInt aTextEncodingOop;
	TextEncoding inScriptID;
	MenuHandle menuHandle;
	sqInt menuHandleOop;

	if (!(isIntegerObject((anInteger = stackValue(1))))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(2);
	anInteger = integerValueOf(anInteger);
	aTextEncodingOop = stackValue(0);
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	inScriptID = ((TextEncoding) (positive32BitValueOf(aTextEncodingOop)));
	SetMenuItemTextEncoding(menuHandle,anInteger,inScriptID);
	return null;
}

	/* MacMenubarPlugin>>#primitiveSetMenuTitle:title: */
EXPORT(sqInt)
primitiveSetMenuTitle(void)
{
	ConstStr255Param constStr255;
	MenuHandle menuHandle;
	sqInt menuHandleOop;
	char *str255;

	if (!(isBytes(stackValue(0)))) {
		return primitiveFailFor(PrimErrBadArgument);
	}
	menuHandleOop = stackValue(1);
	str255 = firstIndexableField(stackValue(0));
	menuHandle = ((MenuHandle) (positiveMachineIntegerValueOf(menuHandleOop)));
	if (!(ioCheckMenuHandle(menuHandle))) {
		return success(0);
	}
	constStr255 = ((ConstStr255Param) str255);
	SetMenuTitle(menuHandle,constStr255);
	return null;
}

	/* MacMenubarPlugin>>#primitiveShowMenuBar */
EXPORT(sqInt)
primitiveShowMenuBar(void)
{
	ShowMenuBar();
	return null;
}


/*	Note: This is coded so that it can be run in Squeak. */

	/* InterpreterPlugin>>#setInterpreter: */
EXPORT(sqInt)
setInterpreter(struct VirtualMachine *anInterpreter)
{
	sqInt ok;


	/* This may seem tautological, but in a real plugin it checks that the VM provides
	   the version the plugin was compiled against which is the version the plugin expects. */
	interpreterProxy = anInterpreter;
	ok = ((interpreterProxy->majorVersion()) == (VM_PROXY_MAJOR))
	 && ((interpreterProxy->minorVersion()) >= (VM_PROXY_MINOR));
	if (ok) {
		
#if !defined(SQUEAK_BUILTIN_PLUGIN)
		booleanValueOf = interpreterProxy->booleanValueOf;
		classString = interpreterProxy->classString;
		failed = interpreterProxy->failed;
		falseObject = interpreterProxy->falseObject;
		firstIndexableField = interpreterProxy->firstIndexableField;
		instantiateClassindexableSize = interpreterProxy->instantiateClassindexableSize;
#if !defined(integerObjectOf)
		integerObjectOf = interpreterProxy->integerObjectOf;
#endif
#if !defined(integerValueOf)
		integerValueOf = interpreterProxy->integerValueOf;
#endif
#if VM_PROXY_MAJOR > 1 || (VM_PROXY_MAJOR == 1 && VM_PROXY_MINOR >= 15)
		isBooleanObject = interpreterProxy->isBooleanObject;
#else
#if !defined(isBooleanObject)
		isBooleanObject = 0;
#endif
#endif
		isBytes = interpreterProxy->isBytes;
#if !defined(isIntegerObject)
		isIntegerObject = interpreterProxy->isIntegerObject;
#endif
		methodReturnInteger = interpreterProxy->methodReturnInteger;
		methodReturnValue = interpreterProxy->methodReturnValue;
		positive32BitIntegerFor = interpreterProxy->positive32BitIntegerFor;
		positive32BitValueOf = interpreterProxy->positive32BitValueOf;
		positive64BitIntegerFor = interpreterProxy->positive64BitIntegerFor;
		positiveMachineIntegerValueOf = interpreterProxy->positiveMachineIntegerValueOf;
		primitiveFailFor = interpreterProxy->primitiveFailFor;
		stackValue = interpreterProxy->stackValue;
		success = interpreterProxy->success;
		trueObject = interpreterProxy->trueObject;
#endif /* !defined(SQUEAK_BUILTIN_PLUGIN) */
	}
	return ok;
}


#ifdef SQUEAK_BUILTIN_PLUGIN

static char _m[] = "MacMenubarPlugin";
void* MacMenubarPlugin_exports[][3] = {
	{(void*)_m, "getModuleName", (void*)getModuleName},
	{(void*)_m, "primitiveAppendMenu\000\001\000", (void*)primitiveAppendMenu},
	{(void*)_m, "primitiveAppendMenuItemText\000\001\000", (void*)primitiveAppendMenuItemText},
	{(void*)_m, "primitiveCheckMenuItem\000\000\000", (void*)primitiveCheckMenuItem},
	{(void*)_m, "primitiveClearMenuBar\000\377\000", (void*)primitiveClearMenuBar},
	{(void*)_m, "primitiveCountMenuItems\000\000\000", (void*)primitiveCountMenuItems},
	{(void*)_m, "primitiveCreateStandardWindowMenu\000\000\000", (void*)primitiveCreateStandardWindowMenu},
	{(void*)_m, "primitiveDeleteMenu\000\000\000", (void*)primitiveDeleteMenu},
	{(void*)_m, "primitiveDeleteMenuItem\000\000\000", (void*)primitiveDeleteMenuItem},
	{(void*)_m, "primitiveDisableMenuCommand\000\000\000", (void*)primitiveDisableMenuCommand},
	{(void*)_m, "primitiveDisableMenuItem\000\000\000", (void*)primitiveDisableMenuItem},
	{(void*)_m, "primitiveDisableMenuItemIcon\000\000\000", (void*)primitiveDisableMenuItemIcon},
	{(void*)_m, "primitiveDisposeMenu\000\000\000", (void*)primitiveDisposeMenu},
	{(void*)_m, "primitiveDisposeMenuBar\000\000\000", (void*)primitiveDisposeMenuBar},
	{(void*)_m, "primitiveDrawMenuBar\000\377\000", (void*)primitiveDrawMenuBar},
	{(void*)_m, "primitiveEnableMenuCommand\000\000\000", (void*)primitiveEnableMenuCommand},
	{(void*)_m, "primitiveEnableMenuItem\000\000\000", (void*)primitiveEnableMenuItem},
	{(void*)_m, "primitiveEnableMenuItemIcon\000\000\000", (void*)primitiveEnableMenuItemIcon},
	{(void*)_m, "primitiveGetIndMenuItemWithCommandID\000\000\000", (void*)primitiveGetIndMenuItemWithCommandID},
	{(void*)_m, "primitiveGetIndMenuWithCommandID\000\000\000", (void*)primitiveGetIndMenuWithCommandID},
	{(void*)_m, "primitiveGetItemCmd\000\000\000", (void*)primitiveGetItemCmd},
	{(void*)_m, "primitiveGetItemIcon\000\000\000", (void*)primitiveGetItemIcon},
	{(void*)_m, "primitiveGetItemMark\000\000\000", (void*)primitiveGetItemMark},
	{(void*)_m, "primitiveGetItemStyle\000\000\000", (void*)primitiveGetItemStyle},
	{(void*)_m, "primitiveGetMenuBar\000\377\000", (void*)primitiveGetMenuBar},
	{(void*)_m, "primitiveGetMenuHandle\000\000\000", (void*)primitiveGetMenuHandle},
	{(void*)_m, "primitiveGetMenuID\000\000\000", (void*)primitiveGetMenuID},
	{(void*)_m, "primitiveGetMenuItemCommandID\000\000\000", (void*)primitiveGetMenuItemCommandID},
	{(void*)_m, "primitiveGetMenuItemFontID\000\000\000", (void*)primitiveGetMenuItemFontID},
	{(void*)_m, "primitiveGetMenuItemHierarchicalID\000\000\000", (void*)primitiveGetMenuItemHierarchicalID},
	{(void*)_m, "primitiveGetMenuItemKeyGlyph\000\000\000", (void*)primitiveGetMenuItemKeyGlyph},
	{(void*)_m, "primitiveGetMenuItemModifiers\000\000\000", (void*)primitiveGetMenuItemModifiers},
	{(void*)_m, "primitiveGetMenuItemText\000\000\000", (void*)primitiveGetMenuItemText},
	{(void*)_m, "primitiveGetMenuItemTextEncoding\000\000\000", (void*)primitiveGetMenuItemTextEncoding},
	{(void*)_m, "primitiveGetMenuTitle\000\000\000", (void*)primitiveGetMenuTitle},
	{(void*)_m, "primitiveHideMenuBar\000\377\000", (void*)primitiveHideMenuBar},
	{(void*)_m, "primitiveHiliteMenu\000\000\000", (void*)primitiveHiliteMenu},
	{(void*)_m, "primitiveInsertFontResMenu\000\000\000", (void*)primitiveInsertFontResMenu},
	{(void*)_m, "primitiveInsertIntlResMenu\000\000\000", (void*)primitiveInsertIntlResMenu},
	{(void*)_m, "primitiveInsertMenu\000\000\000", (void*)primitiveInsertMenu},
	{(void*)_m, "primitiveInsertMenuItem\000\001\000", (void*)primitiveInsertMenuItem},
	{(void*)_m, "primitiveInvalMenuBar\000\377\000", (void*)primitiveInvalMenuBar},
	{(void*)_m, "primitiveIsMenuBarVisible\000\377\000", (void*)primitiveIsMenuBarVisible},
	{(void*)_m, "primitiveIsMenuItemEnabled\000\000\000", (void*)primitiveIsMenuItemEnabled},
	{(void*)_m, "primitiveIsMenuItemIconEnabled\000\000\000", (void*)primitiveIsMenuItemIconEnabled},
	{(void*)_m, "primitiveNewMenu\000\001\000", (void*)primitiveNewMenu},
	{(void*)_m, "primitiveSetItemCmd\000\000\000", (void*)primitiveSetItemCmd},
	{(void*)_m, "primitiveSetItemIcon\000\000\000", (void*)primitiveSetItemIcon},
	{(void*)_m, "primitiveSetItemMark\000\000\000", (void*)primitiveSetItemMark},
	{(void*)_m, "primitiveSetItemStyle\000\000\000", (void*)primitiveSetItemStyle},
	{(void*)_m, "primitiveSetMenuBar\000\000\000", (void*)primitiveSetMenuBar},
	{(void*)_m, "primitiveSetMenuItemCommandID\000\000\000", (void*)primitiveSetMenuItemCommandID},
	{(void*)_m, "primitiveSetMenuItemFontID\000\000\000", (void*)primitiveSetMenuItemFontID},
	{(void*)_m, "primitiveSetMenuItemHierarchicalID\000\000\000", (void*)primitiveSetMenuItemHierarchicalID},
	{(void*)_m, "primitiveSetMenuItemKeyGlyph\000\000\000", (void*)primitiveSetMenuItemKeyGlyph},
	{(void*)_m, "primitiveSetMenuItemModifiers\000\000\000", (void*)primitiveSetMenuItemModifiers},
	{(void*)_m, "primitiveSetMenuItemText\000\001\000", (void*)primitiveSetMenuItemText},
	{(void*)_m, "primitiveSetMenuItemTextEncoding\000\000\000", (void*)primitiveSetMenuItemTextEncoding},
	{(void*)_m, "primitiveSetMenuTitle\000\001\000", (void*)primitiveSetMenuTitle},
	{(void*)_m, "primitiveShowMenuBar\000\377\000", (void*)primitiveShowMenuBar},
	{(void*)_m, "setInterpreter", (void*)setInterpreter},
	{NULL, NULL, NULL}
};

#else // ifdef SQ_BUILTIN_PLUGIN

#if SPURVM
EXPORT(signed short) primitiveAppendMenuMetadata = 0x100;
EXPORT(signed short) primitiveAppendMenuItemTextMetadata = 0x100;
EXPORT(signed short) primitiveCheckMenuItemMetadata = 0;
EXPORT(signed short) primitiveCountMenuItemsMetadata = 0;
EXPORT(signed short) primitiveCreateStandardWindowMenuMetadata = 0;
EXPORT(signed short) primitiveDeleteMenuMetadata = 0;
EXPORT(signed short) primitiveDeleteMenuItemMetadata = 0;
EXPORT(signed short) primitiveDisableMenuCommandMetadata = 0;
EXPORT(signed short) primitiveDisableMenuItemMetadata = 0;
EXPORT(signed short) primitiveDisableMenuItemIconMetadata = 0;
EXPORT(signed short) primitiveDisposeMenuMetadata = 0;
EXPORT(signed short) primitiveDisposeMenuBarMetadata = 0;
EXPORT(signed short) primitiveEnableMenuCommandMetadata = 0;
EXPORT(signed short) primitiveEnableMenuItemMetadata = 0;
EXPORT(signed short) primitiveEnableMenuItemIconMetadata = 0;
EXPORT(signed short) primitiveGetIndMenuItemWithCommandIDMetadata = 0;
EXPORT(signed short) primitiveGetIndMenuWithCommandIDMetadata = 0;
EXPORT(signed short) primitiveGetItemCmdMetadata = 0;
EXPORT(signed short) primitiveGetItemIconMetadata = 0;
EXPORT(signed short) primitiveGetItemMarkMetadata = 0;
EXPORT(signed short) primitiveGetItemStyleMetadata = 0;
EXPORT(signed short) primitiveGetMenuHandleMetadata = 0;
EXPORT(signed short) primitiveGetMenuIDMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemCommandIDMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemFontIDMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemHierarchicalIDMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemKeyGlyphMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemModifiersMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemTextMetadata = 0;
EXPORT(signed short) primitiveGetMenuItemTextEncodingMetadata = 0;
EXPORT(signed short) primitiveGetMenuTitleMetadata = 0;
EXPORT(signed short) primitiveHiliteMenuMetadata = 0;
EXPORT(signed short) primitiveInsertFontResMenuMetadata = 0;
EXPORT(signed short) primitiveInsertIntlResMenuMetadata = 0;
EXPORT(signed short) primitiveInsertMenuMetadata = 0;
EXPORT(signed short) primitiveInsertMenuItemMetadata = 0x100;
EXPORT(signed short) primitiveIsMenuItemEnabledMetadata = 0;
EXPORT(signed short) primitiveIsMenuItemIconEnabledMetadata = 0;
EXPORT(signed short) primitiveNewMenuMetadata = 0x100;
EXPORT(signed short) primitiveSetItemCmdMetadata = 0;
EXPORT(signed short) primitiveSetItemIconMetadata = 0;
EXPORT(signed short) primitiveSetItemMarkMetadata = 0;
EXPORT(signed short) primitiveSetItemStyleMetadata = 0;
EXPORT(signed short) primitiveSetMenuBarMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemCommandIDMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemFontIDMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemHierarchicalIDMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemKeyGlyphMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemModifiersMetadata = 0;
EXPORT(signed short) primitiveSetMenuItemTextMetadata = 0x100;
EXPORT(signed short) primitiveSetMenuItemTextEncodingMetadata = 0;
EXPORT(signed short) primitiveSetMenuTitleMetadata = 0x100;
#endif // SPURVM

#endif // ifdef SQ_BUILTIN_PLUGIN
